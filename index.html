<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Safio ‚Äî Entrez l'esprit tranquille</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  :root {
    --green: #00E87A;
    --green-dark: #00C065;
    --green-glow: rgba(0,232,122,0.2);
    --red: #FF3B5C;
    --orange: #FF8C00;
    --bg: #0A0A0F;
    --bg2: #111118;
    --bg3: #1A1A24;
    --card: #16161F;
    --border: rgba(255,255,255,0.07);
    --text: #F0F0F8;
    --muted: rgba(240,240,248,0.45);
    --accent: #00E87A;
  }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  /* PHONE FRAME */
  .phone {
    width: 390px;
    height: 844px;
    background: var(--bg);
    border-radius: 54px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 0 12px #1C1C1E, 0 0 0 14px #2C2C2E, 0 40px 120px rgba(0,0,0,0.8), 0 0 60px rgba(0,232,122,0.06);
  }

  /* NOTCH */
  .notch {
    position: absolute;
    top: 0; left: 50%;
    transform: translateX(-50%);
    width: 126px; height: 34px;
    background: #0A0A0F;
    border-radius: 0 0 20px 20px;
    z-index: 100;
  }

  /* STATUS BAR */
  .status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 28px 0;
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
    position: relative;
    z-index: 99;
  }
  .status-bar .time { font-size: 15px; font-weight: 700; }
  .status-icons { display: flex; gap: 6px; align-items: center; }
  .status-icons svg { opacity: 0.9; }

  /* SCREENS */
  .screen {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    overflow-y: auto;
    overflow-x: hidden;
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
    scrollbar-width: none;
    transition: opacity 0.2s ease;
  }
  .screen::-webkit-scrollbar { display: none; }
  .screen.active {
    visibility: visible;
    opacity: 1;
    pointer-events: all;
  }

  /* ‚îÄ‚îÄ SPLASH SCREEN ‚îÄ‚îÄ */
  #splash {
    background: radial-gradient(ellipse at 50% 40%, rgba(0,232,122,0.15) 0%, transparent 70%), var(--bg);
  }
  #splash > div {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
  }
  .splash-logo {
    font-family: 'Syne', sans-serif;
    font-size: 52px;
    font-weight: 800;
    letter-spacing: -2px;
    color: var(--green);
    animation: pulse 2s ease-in-out infinite;
  }
  .splash-logo span { color: var(--text); }
  .splash-tagline {
    color: var(--muted);
    font-size: 14px;
    margin-top: 8px;
    letter-spacing: 0.5px;
  }
  .splash-orb {
    width: 180px; height: 180px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(0,232,122,0.3) 0%, transparent 70%);
    position: absolute;
    animation: float 3s ease-in-out infinite;
    filter: blur(20px);
  }
  @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-15px)} }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.7} }

  .role-cards {
    display: flex;
    flex-direction: column;
    gap: 14px;
    padding: 0 28px;
    width: 100%;
    margin-top: 48px;
    position: relative;
    z-index: 2;
  }
  .role-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 22px 24px;
    display: flex;
    align-items: center;
    gap: 18px;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
    overflow: hidden;
  }
  .role-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(0,232,122,0.08) 0%, transparent 60%);
    opacity: 0;
    transition: opacity 0.25s;
  }
  .role-card:active::before { opacity: 1; }
  .role-card:active { transform: scale(0.97); }
  .role-icon {
    width: 52px; height: 52px;
    border-radius: 16px;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px;
    flex-shrink: 0;
  }
  .role-icon.client { background: rgba(0,232,122,0.15); }
  .role-icon.bar { background: rgba(255,140,0,0.15); }
  .role-info { flex: 1; }
  .role-title {
    font-family: 'Syne', sans-serif;
    font-size: 17px;
    font-weight: 700;
    margin-bottom: 3px;
  }
  .role-desc { font-size: 13px; color: var(--muted); line-height: 1.4; }
  .role-arrow { color: var(--muted); font-size: 18px; }

  /* ‚îÄ‚îÄ CLIENT SCREEN ‚îÄ‚îÄ */
  #client { background: var(--bg); }
  
  .client-header {
    padding: 52px 24px 20px;
    background: linear-gradient(to bottom, rgba(0,232,122,0.05), transparent);
  }
  .header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
  .app-logo-small {
    font-family: 'Syne', sans-serif;
    font-size: 22px;
    font-weight: 800;
    color: var(--green);
    letter-spacing: -0.5px;
  }
  .back-btn {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 8px 14px;
    font-size: 13px;
    color: var(--muted);
    cursor: pointer;
  }
  .back-btn:active { opacity: 0.7; }

  .location-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(0,232,122,0.1);
    border: 1px solid rgba(0,232,122,0.25);
    border-radius: 20px;
    padding: 8px 14px;
    font-size: 13px;
    color: var(--green);
    margin-bottom: 16px;
  }
  .location-dot {
    width: 7px; height: 7px;
    background: var(--green);
    border-radius: 50%;
    animation: blink 1.5s ease-in-out infinite;
  }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

  .section-title {
    font-family: 'Syne', sans-serif;
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 4px;
  }
  .section-sub { font-size: 13px; color: var(--muted); }

  /* MAP */
  .map-container {
    margin: 0 24px 20px;
    border-radius: 20px;
    overflow: hidden;
    height: 180px;
    background: var(--card);
    border: 1px solid var(--border);
    position: relative;
  }
  /* Leaflet overrides dark */
  .leaflet-tile-pane { filter: brightness(0.85) saturate(0.7); }
  .leaflet-control-attribution { display: none; }
  .leaflet-control-zoom { display: none; }
  .safio-marker {
    background: #00E87A;
    color: #000;
    font-family: 'Syne', sans-serif;
    font-size: 11px;
    font-weight: 800;
    padding: 4px 8px;
    border-radius: 10px;
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0,232,122,0.5);
    cursor: pointer;
  }
  .safio-marker.orange {
    background: #FF8C00;
    box-shadow: 0 4px 12px rgba(255,140,0,0.5);
  }

  /* BAR CARDS */
  .bars-list { padding: 0 24px 96px; display: flex; flex-direction: column; gap: 14px; }

  .bar-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 18px 20px;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
  }
  .bar-card::after {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: var(--green);
    border-radius: 0 2px 2px 0;
  }
  .bar-card:active { transform: scale(0.98); }
  .bar-card-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
  }
  .bar-name {
    font-family: 'Syne', sans-serif;
    font-size: 17px;
    font-weight: 700;
  }
  .bar-type { font-size: 12px; color: var(--muted); margin-top: 2px; }

  .score-badge {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0,232,122,0.1);
    border: 1px solid rgba(0,232,122,0.25);
    border-radius: 14px;
    padding: 8px 14px;
    min-width: 62px;
  }
  .score-badge.orange {
    background: rgba(255,140,0,0.1);
    border-color: rgba(255,140,0,0.25);
  }
  .score-num {
    font-family: 'Syne', sans-serif;
    font-size: 22px;
    font-weight: 800;
    color: var(--green);
    line-height: 1;
  }
  .score-num.orange { color: var(--orange); }
  .score-label { font-size: 10px; color: var(--muted); margin-top: 2px; }

  .score-bar-wrap {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  .score-bar-track {
    flex: 1;
    height: 6px;
    background: rgba(255,255,255,0.06);
    border-radius: 3px;
    overflow: hidden;
  }
  .score-bar-fill {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, var(--green-dark), var(--green));
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .score-bar-fill.orange {
    background: linear-gradient(90deg, #CC7000, var(--orange));
  }
  .score-pct { font-size: 12px; color: var(--muted); width: 32px; text-align: right; }

  .bar-meta {
    display: flex;
    gap: 16px;
    font-size: 12px;
    color: var(--muted);
  }
  .bar-meta-item { display: flex; align-items: center; gap: 4px; }

  .certif-pills {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-top: 10px;
  }
  .certif-pill {
    background: rgba(0,232,122,0.08);
    border: 1px solid rgba(0,232,122,0.15);
    border-radius: 8px;
    padding: 3px 9px;
    font-size: 11px;
    color: var(--green);
  }
  .certif-pill.warning {
    background: rgba(255,59,92,0.08);
    border-color: rgba(255,59,92,0.15);
    color: var(--red);
  }

  /* TAB BAR */
  .tab-bar {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 84px;
    background: rgba(10,10,15,0.97);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid var(--border);
    display: none;
    align-items: flex-start;
    padding-top: 12px;
    z-index: 200;
    flex-shrink: 0;
  }
  .tab-bar.visible { display: flex; }
  .tab-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    cursor: pointer;
    padding: 4px 0;
  }
  .tab-icon { font-size: 22px; opacity: 0.4; }
  .tab-icon.active { opacity: 1; }
  .tab-txt { font-size: 10px; color: var(--muted); }
  .tab-txt.active { color: var(--green); }

  /* ‚îÄ‚îÄ BAR OWNER SCREEN ‚îÄ‚îÄ */
  #barowner { background: var(--bg); }

  .bar-header {
    padding: 52px 24px 24px;
    background: linear-gradient(to bottom, rgba(255,140,0,0.06), transparent);
  }
  .bar-header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .establishment-name {
    font-family: 'Syne', sans-serif;
    font-size: 24px;
    font-weight: 800;
    margin-bottom: 4px;
  }
  .establishment-sub { font-size: 13px; color: var(--muted); }

  /* BIG SCORE */
  .big-score-card {
    margin: 0 24px 20px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 24px;
    padding: 28px 24px;
    position: relative;
    overflow: hidden;
  }
  .big-score-card::before {
    content: '';
    position: absolute;
    top: -40px; right: -40px;
    width: 160px; height: 160px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,140,0,0.12) 0%, transparent 70%);
  }
  .score-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }
  .big-score-num {
    font-family: 'Syne', sans-serif;
    font-size: 72px;
    font-weight: 800;
    color: var(--orange);
    line-height: 1;
  }
  .big-score-denom {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 600;
    color: var(--muted);
    align-self: flex-end;
    padding-bottom: 10px;
  }
  .score-ring {
    width: 90px; height: 90px;
    position: relative;
  }
  .score-ring svg { transform: rotate(-90deg); }
  .ring-bg { fill: none; stroke: rgba(255,255,255,0.06); stroke-width: 8; }
  .ring-fill { fill: none; stroke: var(--orange); stroke-width: 8; stroke-linecap: round;
    stroke-dasharray: 226; stroke-dashoffset: 45; transition: stroke-dashoffset 1s ease; }
  .ring-label {
    position: absolute;
    inset: 0;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne', sans-serif;
    font-size: 18px; font-weight: 800;
    color: var(--orange);
  }

  .score-label-main {
    font-size: 13px; color: var(--muted); margin-bottom: 6px;
  }
  .score-trend {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: rgba(0,232,122,0.1);
    border: 1px solid rgba(0,232,122,0.2);
    border-radius: 10px;
    padding: 4px 10px;
    font-size: 12px;
    color: var(--green);
    font-weight: 600;
  }

  /* CRITERIA */
  .criteria-section { padding: 0 24px 20px; }
  .criteria-title {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 14px;
  }
  .criteria-list { display: flex; flex-direction: column; gap: 10px; }
  .criteria-item {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 14px 16px;
    display: flex;
    align-items: center;
    gap: 14px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .criteria-item:active { transform: scale(0.98); }
  .criteria-icon {
    width: 40px; height: 40px;
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px;
    flex-shrink: 0;
  }
  .ci-green { background: rgba(0,232,122,0.1); }
  .ci-orange { background: rgba(255,140,0,0.1); }
  .ci-red { background: rgba(255,59,92,0.1); }
  .criteria-info { flex: 1; }
  .criteria-name { font-size: 14px; font-weight: 500; margin-bottom: 4px; }
  .criteria-bar-wrap { display: flex; align-items: center; gap: 8px; }
  .criteria-bar-track {
    flex: 1; height: 4px;
    background: rgba(255,255,255,0.06);
    border-radius: 2px; overflow: hidden;
  }
  .criteria-bar-fill {
    height: 100%; border-radius: 2px;
    background: var(--green);
  }
  .criteria-bar-fill.orange { background: var(--orange); }
  .criteria-bar-fill.red { background: var(--red); }
  .criteria-pct { font-size: 12px; color: var(--muted); }
  .criteria-status {
    font-size: 11px;
    padding: 3px 10px;
    border-radius: 8px;
    font-weight: 600;
  }
  .cs-ok { background: rgba(0,232,122,0.1); color: var(--green); }
  .cs-warn { background: rgba(255,140,0,0.1); color: var(--orange); }
  .cs-bad { background: rgba(255,59,92,0.1); color: var(--red); }

  /* ACTIONS */
  .actions-section { padding: 0 24px 96px; }
  .actions-title {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 14px;
  }
  .action-btn {
    width: 100%;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    gap: 14px;
    cursor: pointer;
    margin-bottom: 10px;
    transition: all 0.2s;
  }
  .action-btn:active { transform: scale(0.98); opacity: 0.8; }
  .action-btn-icon {
    width: 44px; height: 44px;
    border-radius: 14px;
    background: rgba(0,232,122,0.1);
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .action-btn-icon.orange { background: rgba(255,140,0,0.1); }
  .action-btn-text { flex: 1; }
  .action-btn-title { font-size: 15px; font-weight: 500; }
  .action-btn-sub { font-size: 12px; color: var(--muted); margin-top: 2px; }
  .action-btn-arrow { color: var(--muted); }

  /* MODAL DETAIL BAR */
  .modal-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: none;
    align-items: flex-end;
  }
  .modal-overlay.open { display: flex; }
  .modal-sheet {
    width: 100%;
    background: var(--bg2);
    border-radius: 28px 28px 0 0;
    border-top: 1px solid var(--border);
    padding: 12px 24px 40px;
    max-height: 80%;
    overflow-y: auto;
  }
  .modal-sheet::-webkit-scrollbar { display: none; }
  .modal-handle {
    width: 36px; height: 4px;
    background: rgba(255,255,255,0.15);
    border-radius: 2px;
    margin: 0 auto 20px;
  }
  .modal-bar-name {
    font-family: 'Syne', sans-serif;
    font-size: 24px;
    font-weight: 800;
    margin-bottom: 4px;
  }
  .modal-bar-addr { font-size: 13px; color: var(--muted); margin-bottom: 20px; }
  .modal-score-big {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
    background: var(--card);
    border-radius: 18px;
    padding: 16px 20px;
    border: 1px solid var(--border);
  }
  .modal-score-num {
    font-family: 'Syne', sans-serif;
    font-size: 48px;
    font-weight: 800;
    color: var(--green);
    line-height: 1;
  }
  .modal-score-num.orange { color: var(--orange); }
  .modal-score-info { flex: 1; }
  .modal-score-label { font-size: 13px; color: var(--muted); margin-bottom: 6px; }
  .modal-score-bar-track {
    height: 8px;
    background: rgba(255,255,255,0.06);
    border-radius: 4px; overflow: hidden;
  }
  .modal-score-bar-fill {
    height: 100%; border-radius: 4px;
    background: linear-gradient(90deg, var(--green-dark), var(--green));
  }
  .modal-score-bar-fill.orange {
    background: linear-gradient(90deg, #CC7000, var(--orange));
  }
  .modal-section-title {
    font-family: 'Syne', sans-serif;
    font-size: 14px;
    font-weight: 700;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 12px;
  }
  .modal-detail-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 20px;
  }
  .modal-detail-item {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 12px 14px;
  }
  .modal-detail-label { font-size: 11px; color: var(--muted); margin-bottom: 4px; }
  .modal-detail-value { font-size: 14px; font-weight: 600; }
  .modal-detail-value.green { color: var(--green); }
  .modal-detail-value.orange { color: var(--orange); }
  .modal-detail-value.red { color: var(--red); }
  .modal-cta {
    width: 100%;
    background: var(--green);
    color: #000;
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    border: none;
    border-radius: 16px;
    padding: 17px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center; gap: 8px;
    margin-top: 8px;
    transition: all 0.2s;
  }
  .modal-cta:active { transform: scale(0.97); background: var(--green-dark); }

  /* TOAST */
  .toast {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 12px 20px;
    font-size: 13px;
    white-space: nowrap;
    z-index: 300;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
  }
  .toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  /* Animations d'entr√©e */
  @keyframes slideUp {
    from { transform: translateY(30px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  .bar-card { animation: slideUp 0.4s ease both; }
  .bar-card:nth-child(1) { animation-delay: 0.1s; }
  .bar-card:nth-child(2) { animation-delay: 0.2s; }
  .bar-card:nth-child(3) { animation-delay: 0.3s; }

  /* Desktop hint */
  @media (min-width: 500px) {
    body { background: #070708; }
  }
</style>
</head>
<body>

<!-- PHONE FRAME -->
<div class="phone">
  <div class="notch"></div>

  <!-- STATUS BAR -->
  <div class="status-bar">
    <span class="time" id="clock">09:41</span>
    <div class="status-icons">
      <svg width="17" height="12" viewBox="0 0 17 12" fill="white">
        <rect x="0" y="3" width="3" height="9" rx="1" opacity="0.3"/>
        <rect x="4.5" y="2" width="3" height="10" rx="1" opacity="0.5"/>
        <rect x="9" y="0" width="3" height="12" rx="1" opacity="0.7"/>
        <rect x="13.5" y="0" width="3" height="12" rx="1"/>
      </svg>
      <svg width="16" height="12" viewBox="0 0 16 12" fill="white">
        <path d="M8 2.4C5.6 2.4 3.4 3.4 1.8 5L0 3.2C2.2 1.2 5 0 8 0s5.8 1.2 8 3.2L14.2 5C12.6 3.4 10.4 2.4 8 2.4z"/>
        <path d="M8 6.4c-1.4 0-2.6.6-3.5 1.5L3 6.4C4.3 5 6 4.2 8 4.2s3.7.8 5 2.2l-1.5 1.5C10.6 7 9.4 6.4 8 6.4z"/>
        <circle cx="8" cy="11" r="1.5"/>
      </svg>
      <svg width="25" height="12" viewBox="0 0 25 12" fill="white">
        <rect x="0" y="1" width="21" height="10" rx="3" stroke="white" stroke-width="1.5" fill="none" opacity="0.4"/>
        <rect x="22" y="4" width="3" height="4" rx="1" opacity="0.4"/>
        <rect x="1.5" y="2.5" width="16" height="7" rx="2" fill="white"/>
      </svg>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SPLASH SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen active" id="splash">
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:40px 28px;">
      <div class="splash-orb"></div>
      <div style="position:relative;z-index:2;text-align:center;margin-bottom:60px;">
        <div class="splash-logo">safe<span>io</span></div>
        <div class="splash-tagline">Entrez l'esprit tranquille</div>
      </div>
      <div class="role-cards" style="margin-top:0;">
        <div class="role-card" onclick="goTo('client')">
          <div class="role-icon client">üß≠</div>
          <div class="role-info">
            <div class="role-title">Je suis un client</div>
            <div class="role-desc">Trouvez des bars s√©curis√©s pr√®s de vous √† Tours</div>
          </div>
          <div class="role-arrow">‚Ä∫</div>
        </div>
        <div class="role-card" onclick="goTo('barowner')">
          <div class="role-icon bar">üè™</div>
          <div class="role-info">
            <div class="role-title">Je g√®re un √©tablissement</div>
            <div class="role-desc">Consultez et am√©liorez votre score de s√©curit√©</div>
          </div>
          <div class="role-arrow">‚Ä∫</div>
        </div>
      </div>
      <div style="margin-top:32px;font-size:12px;color:rgba(240,240,248,0.25);text-align:center;line-height:1.5;">
        Donn√©es ERP ‚Ä¢ Certificats de s√©curit√©<br>Transparence pour tous
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CLIENT SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="client">
    <div class="client-header">
      <div class="header-top">
        <div class="app-logo-small">safio</div>
        <div class="back-btn" onclick="goTo('splash')">‚Üê Retour</div>
      </div>
      <div class="location-pill" id="locationPill">
        <div class="location-dot"></div>
        <span id="locationText">Localisation en cours‚Ä¶</span>
      </div>
      <div class="section-title">Bars pr√®s de vous</div>
      <div class="section-sub">3 √©tablissements ‚Ä¢ Tours, Indre-et-Loire</div>
    </div>

    <!-- MAP LEAFLET -->
    <div class="map-container" id="mapContainer">
      <div id="leafletMap" style="width:100%;height:100%;"></div>
    </div>

    <!-- BARS LIST -->
    <div class="bars-list">

      <!-- Bar 1 -->
      <div class="bar-card" onclick="openModal(0)">
        <div class="bar-card-top">
          <div>
            <div class="bar-name">Le Vieux Murier</div>
            <div class="bar-type">Bar ‚Äî 12 Place Plumereau</div>
          </div>
          <div class="score-badge">
            <div class="score-num">82</div>
            <div class="score-label">/100</div>
          </div>
        </div>
        <div class="score-bar-wrap">
          <div class="score-bar-track"><div class="score-bar-fill" style="width:82%"></div></div>
          <div class="score-pct">82%</div>
        </div>
        <div class="bar-meta">
          <div class="bar-meta-item">üìç 320m</div>
          <div class="bar-meta-item">üïê Ouvert</div>
          <div class="bar-meta-item">üë• ~40 pers.</div>
        </div>
        <div class="certif-pills">
          <div class="certif-pill">‚úì Extincteurs</div>
          <div class="certif-pill">‚úì Issues secours</div>
          <div class="certif-pill warning">‚ö† D√©tecteurs</div>
        </div>
      </div>

      <!-- Bar 2 -->
      <div class="bar-card" style="border-color:rgba(255,140,0,0.2);" onclick="openModal(1)">
        <div style="position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--orange);border-radius:0 2px 2px 0;"></div>
        <div class="bar-card-top">
          <div>
            <div class="bar-name">Bar du Centre</div>
            <div class="bar-type">Bar brasserie ‚Äî 5 Rue Colbert</div>
          </div>
          <div class="score-badge orange">
            <div class="score-num orange">78</div>
            <div class="score-label">/100</div>
          </div>
        </div>
        <div class="score-bar-wrap">
          <div class="score-bar-track"><div class="score-bar-fill orange" style="width:78%"></div></div>
          <div class="score-pct">78%</div>
        </div>
        <div class="bar-meta">
          <div class="bar-meta-item">üìç 150m</div>
          <div class="bar-meta-item">üïê Ouvert</div>
          <div class="bar-meta-item">üë• ~80 pers.</div>
        </div>
        <div class="certif-pills">
          <div class="certif-pill">‚úì Extincteurs</div>
          <div class="certif-pill warning">‚ö† Issues secours</div>
          <div class="certif-pill warning">‚ö† √âclairage</div>
        </div>
      </div>

      <!-- Bar 3 -->
      <div class="bar-card" onclick="openModal(2)">
        <div class="bar-card-top">
          <div>
            <div class="bar-name">La Guinguette</div>
            <div class="bar-type">Bar concert ‚Äî 8 Quai du Portillon</div>
          </div>
          <div class="score-badge">
            <div class="score-num">85</div>
            <div class="score-label">/100</div>
          </div>
        </div>
        <div class="score-bar-wrap">
          <div class="score-bar-track"><div class="score-bar-fill" style="width:85%"></div></div>
          <div class="score-pct">85%</div>
        </div>
        <div class="bar-meta">
          <div class="bar-meta-item">üìç 480m</div>
          <div class="bar-meta-item">üïê Ouvert</div>
          <div class="bar-meta-item">üë• ~120 pers.</div>
        </div>
        <div class="certif-pills">
          <div class="certif-pill">‚úì Extincteurs</div>
          <div class="certif-pill">‚úì Issues secours</div>
          <div class="certif-pill">‚úì D√©tecteurs</div>
        </div>
      </div>

    </div>

    <!-- MODAL DETAIL -->
    <div class="modal-overlay" id="detailModal" onclick="closeModal(event)">
      <div class="modal-sheet" id="modalContent">
        <div class="modal-handle"></div>
        <div class="modal-bar-name" id="modalName">‚Äì</div>
        <div class="modal-bar-addr" id="modalAddr">‚Äì</div>
        <div class="modal-score-big">
          <div class="modal-score-num" id="modalScore">‚Äì</div>
          <div class="modal-score-info">
            <div class="modal-score-label">Score de s√©curit√© ERP</div>
            <div class="modal-score-bar-track">
              <div class="modal-score-bar-fill" id="modalBar" style="width:0%"></div>
            </div>
          </div>
        </div>
        <div class="modal-section-title">D√©tails du certificat</div>
        <div class="modal-detail-grid" id="modalGrid"></div>
        <button class="modal-cta" onclick="navigate()">
          üó∫Ô∏è Y aller
        </button>
        <button class="modal-cta" style="background:var(--card);color:var(--text);border:1px solid var(--border);margin-top:10px;" onclick="showToast('‚≠ê Ajout√© √† vos favoris !')">
          ‚≠ê Sauvegarder
        </button>
      </div>
    </div>

  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BAR OWNER SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="barowner">
    <div class="bar-header">
      <div class="bar-header-top">
        <div class="app-logo-small">safio</div>
        <div class="back-btn" onclick="goTo('splash')">‚Üê Retour</div>
      </div>
      <div class="establishment-name">Bar du Centre</div>
      <div class="establishment-sub">5 Rue Colbert ‚Ä¢ Tours ‚Ä¢ ERP Type N ‚Ä¢ 3e cat√©gorie</div>
    </div>

    <!-- BIG SCORE -->
    <div class="big-score-card">
      <div class="score-row">
        <div>
          <div class="score-label-main">Score global de s√©curit√©</div>
          <div style="display:flex;align-items:baseline;gap:4px;">
            <div class="big-score-num" id="animatedScore">0</div>
            <div class="big-score-denom">/100</div>
          </div>
          <div class="score-trend">‚Üë +3 pts ce trimestre</div>
        </div>
        <div class="score-ring">
          <svg width="90" height="90" viewBox="0 0 90 90">
            <circle class="ring-bg" cx="45" cy="45" r="36"/>
            <circle class="ring-fill" cx="45" cy="45" r="36"/>
          </svg>
          <div class="ring-label">78</div>
        </div>
      </div>
      <div class="score-bar-track" style="height:8px;">
        <div class="score-bar-fill orange" style="width:78%;height:100%;border-radius:4px;"></div>
      </div>
    </div>

    <!-- CRITERIA -->
    <div class="criteria-section">
      <div class="criteria-title">D√©tail par crit√®re</div>
      <div class="criteria-list">

        <div class="criteria-item">
          <div class="criteria-icon ci-green">üî•</div>
          <div class="criteria-info">
            <div class="criteria-name">Extincteurs & syst√®mes anti-incendie</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill" style="width:95%"></div></div>
              <div class="criteria-pct">95%</div>
            </div>
          </div>
          <div class="criteria-status cs-ok">‚úì OK</div>
        </div>

        <div class="criteria-item">
          <div class="criteria-icon ci-orange">üö™</div>
          <div class="criteria-info">
            <div class="criteria-name">Issues de secours</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill orange" style="width:70%"></div></div>
              <div class="criteria-pct">70%</div>
            </div>
          </div>
          <div class="criteria-status cs-warn">‚ö† Action</div>
        </div>

        <div class="criteria-item">
          <div class="criteria-icon ci-orange">üí°</div>
          <div class="criteria-info">
            <div class="criteria-name">√âclairage de s√©curit√©</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill orange" style="width:65%"></div></div>
              <div class="criteria-pct">65%</div>
            </div>
          </div>
          <div class="criteria-status cs-warn">‚ö† Action</div>
        </div>

        <div class="criteria-item">
          <div class="criteria-icon ci-green">üìã</div>
          <div class="criteria-info">
            <div class="criteria-name">Affichages r√©glementaires</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill" style="width:90%"></div></div>
              <div class="criteria-pct">90%</div>
            </div>
          </div>
          <div class="criteria-status cs-ok">‚úì OK</div>
        </div>

        <div class="criteria-item">
          <div class="criteria-icon ci-green">üèóÔ∏è</div>
          <div class="criteria-info">
            <div class="criteria-name">Structure & mat√©riaux</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill" style="width:85%"></div></div>
              <div class="criteria-pct">85%</div>
            </div>
          </div>
          <div class="criteria-status cs-ok">‚úì OK</div>
        </div>

        <div class="criteria-item">
          <div class="criteria-icon ci-red">üîî</div>
          <div class="criteria-info">
            <div class="criteria-name">D√©tecteurs de fum√©e</div>
            <div class="criteria-bar-wrap">
              <div class="criteria-bar-track"><div class="criteria-bar-fill red" style="width:40%"></div></div>
              <div class="criteria-pct">40%</div>
            </div>
          </div>
          <div class="criteria-status cs-bad">‚úó Urgent</div>
        </div>

      </div>
    </div>

    <!-- ACTIONS -->
    <div class="actions-section">
      <div class="actions-title">Actions recommand√©es</div>

      <div class="action-btn" onclick="showToast('üìÖ Prise de rendez-vous ouverte')">
        <div class="action-btn-icon">üìÖ</div>
        <div class="action-btn-text">
          <div class="action-btn-title">Planifier une inspection</div>
          <div class="action-btn-sub">Prochaine visite recommand√©e : mars 2026</div>
        </div>
        <div class="action-btn-arrow">‚Ä∫</div>
      </div>

      <div class="action-btn" onclick="showToast('üì§ Rapport envoy√© √† la commission')">
        <div class="action-btn-icon orange">üì§</div>
        <div class="action-btn-text">
          <div class="action-btn-title">Envoyer mon dossier</div>
          <div class="action-btn-sub">Commission de s√©curit√© d'Indre-et-Loire</div>
        </div>
        <div class="action-btn-arrow">‚Ä∫</div>
      </div>

      <div class="action-btn" onclick="showToast('üìú Certificat t√©l√©charg√©')">
        <div class="action-btn-icon">üìú</div>
        <div class="action-btn-text">
          <div class="action-btn-title">T√©l√©charger mon certificat</div>
          <div class="action-btn-sub">Valide jusqu'au 12 septembre 2026</div>
        </div>
        <div class="action-btn-arrow">‚Ä∫</div>
      </div>

      <div class="action-btn" onclick="showToast('üëÅÔ∏è Aper√ßu de votre fiche publique')">
        <div class="action-btn-icon">üëÅÔ∏è</div>
        <div class="action-btn-text">
          <div class="action-btn-title">Voir ma fiche publique</div>
          <div class="action-btn-sub">Ce que voient vos clients sur Safio</div>
        </div>
        <div class="action-btn-arrow">‚Ä∫</div>
      </div>
    </div>

  </div>

  <!-- TAB BAR CLIENT -->
  <div class="tab-bar" id="tabClient">
    <div class="tab-item">
      <div class="tab-icon active">üó∫Ô∏è</div>
      <div class="tab-txt active">Carte</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">‚≠ê</div>
      <div class="tab-txt">Favoris</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">üîç</div>
      <div class="tab-txt">Chercher</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">üë§</div>
      <div class="tab-txt">Profil</div>
    </div>
  </div>

  <!-- TAB BAR BAR OWNER -->
  <div class="tab-bar" id="tabBar">
    <div class="tab-item">
      <div class="tab-icon active">üè†</div>
      <div class="tab-txt active">Accueil</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">üìä</div>
      <div class="tab-txt">Stats</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">üìã</div>
      <div class="tab-txt">Documents</div>
    </div>
    <div class="tab-item">
      <div class="tab-icon">‚öôÔ∏è</div>
      <div class="tab-txt">R√©glages</div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

</div>

<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
const bars = [
  {
    name: "Le Vieux Murier",
    addr: "12 Place Plumereau, Tours",
    score: 82,
    type: "Bar ‚Ä¢ ERP Type N ‚Ä¢ 5e cat√©gorie",
    capacity: "40 personnes",
    distance: "320m",
    lastInspection: "14 juin 2025",
    nextInspection: "juin 2026",
    scoreClass: "",
    lat: 47.3953, lng: 0.6831,
    details: [
      {label:"Extincteurs",value:"‚úì Conformes",cls:"green"},
      {label:"Issues secours",value:"‚úì Conformes",cls:"green"},
      {label:"D√©tecteurs fum√©e",value:"‚ö† Partiel",cls:"orange"},
      {label:"√âclairage s√©cu.",value:"‚úì Conforme",cls:"green"},
      {label:"Affichages",value:"‚úì Conformes",cls:"green"},
      {label:"Derni√®re visite",value:"juin 2025",cls:""},
    ]
  },
  {
    name: "Bar du Centre",
    addr: "5 Rue Colbert, Tours",
    score: 78,
    type: "Bar brasserie ‚Ä¢ ERP Type N ‚Ä¢ 3e cat√©gorie",
    capacity: "80 personnes",
    distance: "150m",
    lastInspection: "3 mars 2025",
    nextInspection: "mars 2026",
    scoreClass: "orange",
    lat: 47.3935, lng: 0.6862,
    details: [
      {label:"Extincteurs",value:"‚úì Conformes",cls:"green"},
      {label:"Issues secours",value:"‚ö† Action req.",cls:"orange"},
      {label:"D√©tecteurs fum√©e",value:"‚úó Urgent",cls:"red"},
      {label:"√âclairage s√©cu.",value:"‚ö† Partiel",cls:"orange"},
      {label:"Affichages",value:"‚úì Conformes",cls:"green"},
      {label:"Derni√®re visite",value:"mars 2025",cls:""},
    ]
  },
  {
    name: "La Guinguette",
    addr: "8 Quai du Portillon, Tours",
    score: 85,
    type: "Bar concert ‚Ä¢ ERP Type L ‚Ä¢ 2e cat√©gorie",
    capacity: "120 personnes",
    distance: "480m",
    lastInspection: "22 sept. 2025",
    nextInspection: "sept. 2026",
    scoreClass: "",
    lat: 47.3928, lng: 0.6820,
    details: [
      {label:"Extincteurs",value:"‚úì Conformes",cls:"green"},
      {label:"Issues secours",value:"‚úì Conformes",cls:"green"},
      {label:"D√©tecteurs fum√©e",value:"‚úì Conformes",cls:"green"},
      {label:"√âclairage s√©cu.",value:"‚úì Conforme",cls:"green"},
      {label:"Affichages",value:"‚úì Conformes",cls:"green"},
      {label:"Derni√®re visite",value:"sept. 2025",cls:""},
    ]
  }
];

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function goTo(screen) {
  // Masquer tous les √©crans
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  // Masquer toutes les tab bars
  document.querySelectorAll('.tab-bar').forEach(function(t) {
    t.classList.remove('visible');
  });
  // Afficher l'√©cran cible
  var target = document.getElementById(screen);
  if (target) {
    target.classList.add('active');
    target.scrollTop = 0;
  }
  // Afficher la bonne tab bar
  if (screen === 'client') {
    document.getElementById('tabClient').classList.add('visible');
    initGeolocation();
  }
  if (screen === 'barowner') {
    document.getElementById('tabBar').classList.add('visible');
    animateScore();
  }
}

// ‚îÄ‚îÄ MAP LEAFLET ‚îÄ‚îÄ
var leafletMap = null;

function buildMap() {
  if (leafletMap) { leafletMap.invalidateSize(); return; }

  leafletMap = L.map('leafletMap', {
    center: [47.3941, 0.6848],
    zoom: 15,
    zoomControl: false,
    attributionControl: false,
    dragging: true,
    scrollWheelZoom: false
  });

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(leafletMap);

  var barCoords = [
    { lat: 47.3953, lng: 0.6831, idx: 0, score: 82, name: 'Le Vieux Murier', cls: '' },
    { lat: 47.3935, lng: 0.6862, idx: 1, score: 78, name: 'Bar du Centre', cls: 'orange' },
    { lat: 47.3928, lng: 0.6820, idx: 2, score: 85, name: 'La Guinguette', cls: '' },
  ];

  barCoords.forEach(function(b) {
    var icon = L.divIcon({
      className: '',
      html: '<div class="safio-marker ' + b.cls + '">' + b.score + ' ‚Ä¢ ' + b.name + '</div>',
      iconAnchor: [0, 20]
    });
    L.marker([b.lat, b.lng], { icon: icon })
      .addTo(leafletMap)
      .on('click', function() { openModal(b.idx); });
  });

  var userIcon = L.divIcon({
    className: '',
    html: '<div style="width:14px;height:14px;background:#4A9EFF;border-radius:50%;border:3px solid white;box-shadow:0 0 0 5px rgba(74,158,255,0.25);"></div>',
    iconAnchor: [7, 7]
  });
  L.marker([47.3941, 0.6848], { icon: userIcon }).addTo(leafletMap);
}

function loadLeafletThenMap() {
  if (typeof L !== 'undefined') {
    buildMap();
    return;
  }
  var script = document.createElement('script');
  script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
  script.onload = function() { buildMap(); };
  script.onerror = function() { 
    document.getElementById('leafletMap').innerHTML = 
      '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:rgba(255,255,255,0.3);font-size:13px;">üì° Carte non disponible hors ligne</div>';
  };
  document.head.appendChild(script);
}

// ‚îÄ‚îÄ GEOLOCATION ‚îÄ‚îÄ
function initGeolocation() {
  var pill = document.getElementById('locationPill');
  var txt = document.getElementById('locationText');

  loadLeafletThenMap();

  if (!navigator.geolocation) {
    txt.textContent = 'Tours, Indre-et-Loire';
    return;
  }

  txt.textContent = 'Localisation en cours‚Ä¶';

  navigator.geolocation.getCurrentPosition(
    function(pos) {
      txt.textContent = pos.coords.latitude.toFixed(4) + '¬∞N, ' + pos.coords.longitude.toFixed(4) + '¬∞E ‚Ä¢ Tours';
      pill.style.background = 'rgba(0,232,122,0.15)';
      if (leafletMap) leafletMap.panTo([pos.coords.latitude, pos.coords.longitude]);
    },
    function() { txt.textContent = 'Tours, Indre-et-Loire'; },
    { timeout: 5000, maximumAge: 60000 }
  );
}

// ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ
var currentBarIdx = 0;

function openModal(idx) {
  currentBarIdx = idx;
  const bar = bars[idx];
  document.getElementById('modalName').textContent = bar.name;
  document.getElementById('modalAddr').textContent = bar.addr + ' ‚Ä¢ ' + bar.type;

  const scoreEl = document.getElementById('modalScore');
  scoreEl.textContent = bar.score;
  scoreEl.className = 'modal-score-num' + (bar.scoreClass ? ' ' + bar.scoreClass : '');

  const barFill = document.getElementById('modalBar');
  barFill.style.width = bar.score + '%';
  barFill.className = 'modal-score-bar-fill' + (bar.scoreClass ? ' ' + bar.scoreClass : '');

  const grid = document.getElementById('modalGrid');
  grid.innerHTML = bar.details.map(d => `
    <div class="modal-detail-item">
      <div class="modal-detail-label">${d.label}</div>
      <div class="modal-detail-value ${d.cls}">${d.value}</div>
    </div>
  `).join('');

  document.getElementById('detailModal').classList.add('open');
}

function closeModal(e) {
  if (e.target === document.getElementById('detailModal')) {
    document.getElementById('detailModal').classList.remove('open');
  }
}

// ‚îÄ‚îÄ SCORE ANIMATION ‚îÄ‚îÄ
function animateScore() {
  const el = document.getElementById('animatedScore');
  let current = 0;
  const target = 78;
  const duration = 1200;
  const step = target / (duration / 16);

  const timer = setInterval(() => {
    current = Math.min(current + step, target);
    el.textContent = Math.round(current);
    if (current >= target) clearInterval(timer);
  }, 16);
}

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function showToast(msg) {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2800);
}

// ‚îÄ‚îÄ NAVIGATION GPS ‚îÄ‚îÄ
function navigate() {
  var bar = bars[currentBarIdx];
  var lat = bar.lat;
  var lng = bar.lng;
  var name = encodeURIComponent(bar.name);
  var addr = encodeURIComponent(bar.addr);

  // D√©tection iPhone/iOS ‚Üí Apple Maps
  var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  var isMac = /Mac/.test(navigator.userAgent) && navigator.maxTouchPoints > 0;

  if (isIOS || isMac) {
    // Apple Maps ‚Äî ouvre l'app native Maps sur iPhone
    window.location.href = 'maps://maps.apple.com/?daddr=' + lat + ',' + lng + '&dirflg=w&q=' + name;
  } else {
    // Google Maps pour Android/Desktop
    window.open('https://www.google.com/maps/dir/?api=1&destination=' + lat + ',' + lng + '&destination_place_name=' + name + '&travelmode=walking', '_blank');
  }
}

// ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ
function updateClock() {
  const now = new Date();
  const h = String(now.getHours()).padStart(2,'0');
  const m = String(now.getMinutes()).padStart(2,'0');
  document.getElementById('clock').textContent = h + ':' + m;
}
updateClock();
setInterval(updateClock, 1000);
</script>
</body>
</html>
